<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ìˆ˜ìµì¸ì¦ - ga100</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <header class="header">
        <div class="container">
            <div class="header-content">
                <h1 class="logo" onclick="window.location.href='index.html'" style="cursor:pointer">ga100</h1>
                <button class="menu-toggle" onclick="toggleSidebar()">â˜°</button>
            </div>
        </div>
    </header>

    <aside class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <h2>ga100</h2>
            <button class="close-sidebar" onclick="toggleSidebar()">âœ•</button>
        </div>
        <div class="sidebar-section">
            <button class="auth-btn" id="authBtn" onclick="handleAuth()">ë¡œê·¸ì¸</button>
        </div>
    </aside>

    <main class="main-content">
        <div class="container">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px; flex-wrap: wrap; gap: 15px;">
                <h2>ìˆ˜ìµ ì¸ì¦</h2>
                <button class="btn btn-primary" onclick="showUploadForm()" id="uploadBtn" style="display: none;">ìˆ˜ìµ ì¸ì¦ ë“±ë¡</button>
            </div>

            <div id="uploadFormContainer" style="display: none;">
                <div class="admin-panel" style="margin-bottom: 30px;">
                    <h3>ìˆ˜ìµ ì¸ì¦ ë“±ë¡</h3>
                    <form onsubmit="submitRevenue(event)">
                        <div class="form-group">
                            <label>ìˆ˜ìµ ê¸ˆì•¡ (ì›)</label>
                            <input type="number" id="revenueAmount" required min="0">
                        </div>
                        <div class="form-group">
                            <label>ì†Œê° (í•„ìˆ˜)</label>
                            <textarea id="revenueThoughts" required placeholder="ìˆ˜ìµì— ëŒ€í•œ ì†Œê°ì„ ì‘ì„±í•´ì£¼ì„¸ìš”..." style="min-height: 100px;"></textarea>
                        </div>
                        <div class="form-group">
                            <label>ë…¸í•˜ìš°/íŒ (ì„ íƒ)</label>
                            <textarea id="revenueTips" placeholder="ìˆ˜ìµ ì°½ì¶œ ë…¸í•˜ìš°ë‚˜ íŒì„ ê³µìœ í•´ì£¼ì„¸ìš”..." style="min-height: 100px;"></textarea>
                        </div>
                        <div class="form-group">
                            <label>ìˆ˜ìµ ì°½ì¶œ ì£¼ì œ (ì„ íƒ)</label>
                            <input type="text" id="revenueSubject" placeholder="ì˜ˆ: ë¸”ë¡œê·¸, ìœ íŠœë¸Œ, ì›¹ì‚¬ì´íŠ¸ ë“±">
                        </div>
                        <div style="display: flex; gap: 10px;">
                            <button type="submit" class="btn btn-primary">ë“±ë¡í•˜ê¸°</button>
                            <button type="button" class="btn btn-secondary" onclick="hideUploadForm()">ì·¨ì†Œ</button>
                        </div>
                    </form>
                </div>
            </div>

            <div id="revenueList"></div>

            <div id="emptyState" style="display: none; text-align: center; padding: 60px 20px;">
                <div style="font-size: 64px; margin-bottom: 20px;">ğŸ’°</div>
                <h3 style="margin-bottom: 10px;">ì•„ì§ ìˆ˜ìµ ì¸ì¦ì´ ì—†ìŠµë‹ˆë‹¤</h3>
                <p style="color: var(--gray);">ì²« ë²ˆì§¸ ìˆ˜ìµ ì¸ì¦ì„ ë“±ë¡í•´ë³´ì„¸ìš”!</p>
            </div>
        </div>
    </main>

    <footer class="footer">
        <div class="container">
            <div class="footer-links">
                <a href="my-home.html">ë§ˆì´í™ˆ</a>
                <a href="revenue.html">ìˆ˜ìµì¸ì¦</a>
                <a href="courses.html">ì „ìì±…</a>
                <a href="community.html">ì»¤ë®¤ë‹ˆí‹°</a>
            </div>
            <p class="copyright">Â© 2024 ga100. All rights reserved.</p>
        </div>
    </footer>

    <script>
        let currentUser = JSON.parse(localStorage.getItem('currentUser'));

        function toggleSidebar() {
            document.getElementById('sidebar').classList.toggle('active');
        }

        function handleAuth() {
            if (currentUser) {
                localStorage.removeItem('currentUser');
                window.location.reload();
            } else {
                window.location.href = 'login.html';
            }
        }

        function initAuth() {
            const authBtn = document.getElementById('authBtn');
            const uploadBtn = document.getElementById('uploadBtn');
            
            if (currentUser) {
                authBtn.textContent = 'ë¡œê·¸ì•„ì›ƒ';
                uploadBtn.style.display = 'block';
            } else {
                authBtn.textContent = 'ë¡œê·¸ì¸';
                uploadBtn.style.display = 'none';
            }
        }

        function showUploadForm() {
            document.getElementById('uploadFormContainer').style.display = 'block';
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function hideUploadForm() {
            document.getElementById('uploadFormContainer').style.display = 'none';
            document.getElementById('revenueAmount').value = '';
            document.getElementById('revenueThoughts').value = '';
            document.getElementById('revenueTips').value = '';
            document.getElementById('revenueSubject').value = '';
        }

        function submitRevenue(e) {
            e.preventDefault();

            const amount = parseInt(document.getElementById('revenueAmount').value);
            const thoughts = document.getElementById('revenueThoughts').value.trim();
            const tips = document.getElementById('revenueTips').value.trim();
            const subject = document.getElementById('revenueSubject').value.trim();

            let revenues = JSON.parse(localStorage.getItem('revenues') || '[]');
            
            revenues.unshift({
                id: Date.now(),
                author: currentUser.nickname,
                amount: amount,
                thoughts: thoughts,
                tips: tips,
                subject: subject,
                createdAt: new Date().toISOString()
            });

            localStorage.setItem('revenues', JSON.stringify(revenues));
            
            alert('ìˆ˜ìµ ì¸ì¦ì´ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤!');
            hideUploadForm();
            loadRevenues();
        }

        function loadRevenues() {
            const revenues = JSON.parse(localStorage.getItem('revenues') || '[]');
            const list = document.getElementById('revenueList');
            const emptyState = document.getElementById('emptyState');

            if (revenues.length === 0) {
                list.innerHTML = '';
                emptyState.style.display = 'block';
                return;
            }

            emptyState.style.display = 'none';
            list.innerHTML = revenues.map(revenue => `
                <div class="admin-panel" style="margin-bottom: 20px;">
                    <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 15px; flex-wrap: wrap; gap: 10px;">
                        <div>
                            <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 5px;">
                                <strong style="font-size: 18px;">${revenue.author}</strong>
                                ${revenue.subject ? `<span class="badge badge-success">${revenue.subject}</span>` : ''}
                            </div>
                            <span style="color: var(--gray); font-size: 14px;">${new Date(revenue.createdAt).toLocaleDateString('ko-KR')}</span>
                        </div>
                        <div style="font-size: 28px; font-weight: bold; color: var(--primary);">
                            ${revenue.amount.toLocaleString()}ì›
                        </div>
                    </div>
                    
                    <div style="margin-bottom: 15px;">
                        <strong style="color: var(--dark); margin-bottom: 8px; display: block;">ğŸ’­ ì†Œê°</strong>
                        <p style="line-height: 1.6; color: var(--dark);">${revenue.thoughts}</p>
                    </div>
                    
                    ${revenue.tips ? `
                        <div style="margin-bottom: 15px; padding: 15px; background: var(--light-gray); border-radius: 8px;">
                            <strong style="color: var(--dark); margin-bottom: 8px; display: block;">ğŸ’¡ ë…¸í•˜ìš°/íŒ</strong>
                            <p style="line-height: 1.6; color: var(--dark);">${revenue.tips}</p>
                        </div>
                    ` : ''}
                </div>
            `).join('');
        }

        // Initialize
        initAuth();
        loadRevenues();
    </script>
</body>
</html>
